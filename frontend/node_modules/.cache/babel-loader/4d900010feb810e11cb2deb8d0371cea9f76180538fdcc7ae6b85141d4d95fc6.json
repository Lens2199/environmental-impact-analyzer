{"ast":null,"code":"var _jsxFileName = \"/Users/deocherisme/environmental-impact-analyzer/frontend/src/context/AppContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { analysisAPI } from '../services/api';\n\n// Create context\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppContext = /*#__PURE__*/createContext();\n\n/**\n * AppContext Provider Component\n * Manages global application state\n */\nexport const AppProvider = ({\n  children\n}) => {\n  _s();\n  // Recent analyses state\n  const [recentAnalyses, setRecentAnalyses] = useState([]);\n  const [loadingAnalyses, setLoadingAnalyses] = useState(false);\n  const [analysesError, setAnalysesError] = useState(null);\n\n  // Selected products for comparison - initialize as empty array\n  const [selectedProducts, setSelectedProducts] = useState([]);\n\n  // User preferences (could be expanded or stored in localStorage)\n  const [preferences, setPreferences] = useState({\n    darkMode: false,\n    showScores: true,\n    defaultView: 'grid'\n  });\n\n  // Notifications\n  const [notifications, setNotifications] = useState([]);\n\n  // Fetch recent analyses on component mount\n  useEffect(() => {\n    fetchRecentAnalyses();\n    console.log('AppContext initialized');\n  }, []);\n\n  // Function to fetch recent analyses\n  const fetchRecentAnalyses = async () => {\n    try {\n      setLoadingAnalyses(true);\n      setAnalysesError(null);\n      const response = await analysisAPI.getAnalysisHistory();\n      setRecentAnalyses(response.data.analyses || response.data || []);\n    } catch (error) {\n      console.error('Error fetching analyses:', error);\n      setAnalysesError('Failed to load recent analyses');\n    } finally {\n      setLoadingAnalyses(false);\n    }\n  };\n\n  // Add or remove product from selected products for comparison - ENHANCED WITH DEBUGGING\n  const toggleProductSelection = productId => {\n    console.log('toggleProductSelection called with:', productId);\n\n    // Guard against undefined values\n    if (!productId) {\n      console.error('Attempted to toggle selection with invalid productId:', productId);\n      return;\n    }\n    setSelectedProducts(prevSelected => {\n      console.log('Previous selected products:', prevSelected);\n\n      // Make a defensive copy of prevSelected to ensure it's an array\n      const safeSelected = Array.isArray(prevSelected) ? [...prevSelected] : [];\n\n      // Check if already selected\n      if (safeSelected.includes(productId)) {\n        console.log('Removing product from selection');\n        const newSelection = safeSelected.filter(id => id !== productId);\n        console.log('New selection will be:', newSelection);\n        return newSelection;\n      } else {\n        // Add if fewer than 3 already selected\n        if (safeSelected.length < 3) {\n          console.log('Adding product to selection');\n          const newSelection = [...safeSelected, productId];\n          console.log('New selection will be:', newSelection);\n          return newSelection;\n        } else {\n          console.log('Selection limit reached, not adding');\n          // Add notification about max products\n          addNotification({\n            type: 'warning',\n            message: 'You can only compare up to 3 products at a time',\n            duration: 3000\n          });\n          return safeSelected;\n        }\n      }\n    });\n  };\n\n  // Clear all selected products\n  const clearSelectedProducts = () => {\n    console.log('Clearing all selected products');\n    setSelectedProducts([]);\n  };\n\n  // Update user preferences\n  const updatePreferences = newPreferences => {\n    setPreferences({\n      ...preferences,\n      ...newPreferences\n    });\n\n    // In a real app, you might save preferences to localStorage\n    localStorage.setItem('userPreferences', JSON.stringify({\n      ...preferences,\n      ...newPreferences\n    }));\n  };\n\n  // Add notification\n  const addNotification = notification => {\n    const id = Date.now();\n    const newNotification = {\n      id,\n      type: notification.type || 'info',\n      message: notification.message,\n      duration: notification.duration || 5000\n    };\n    setNotifications(prev => [...prev, newNotification]);\n\n    // Auto-remove notification after duration\n    if (newNotification.duration > 0) {\n      setTimeout(() => {\n        removeNotification(id);\n      }, newNotification.duration);\n    }\n  };\n\n  // Remove notification\n  const removeNotification = id => {\n    setNotifications(prev => prev.filter(notification => notification.id !== id));\n  };\n\n  // Load stored preferences from localStorage\n  useEffect(() => {\n    try {\n      const storedPreferences = localStorage.getItem('userPreferences');\n      if (storedPreferences) {\n        setPreferences(JSON.parse(storedPreferences));\n      }\n    } catch (error) {\n      console.error('Error loading preferences:', error);\n    }\n  }, []);\n\n  // Debug effect to log selected products changes\n  useEffect(() => {\n    console.log('selectedProducts state changed to:', selectedProducts);\n  }, [selectedProducts]);\n\n  // Value to be provided by the context\n  const contextValue = {\n    // Analyses\n    recentAnalyses,\n    loadingAnalyses,\n    analysesError,\n    fetchRecentAnalyses,\n    // Products for comparison\n    selectedProducts,\n    toggleProductSelection,\n    clearSelectedProducts,\n    // User preferences\n    preferences,\n    updatePreferences,\n    // Notifications\n    notifications,\n    addNotification,\n    removeNotification\n  };\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: contextValue,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 5\n  }, this);\n};\n_s(AppProvider, \"sI5jHn3j/I0pRTQ8BOeX48NKKVc=\");\n_c = AppProvider;\nAppProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\n/**\n * Custom hook to use the app context\n */\nexport const useAppContext = () => {\n  _s2();\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useAppContext must be used within an AppProvider');\n  }\n  return context;\n  i;\n};\n_s2(useAppContext, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default AppContext;\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","PropTypes","analysisAPI","jsxDEV","_jsxDEV","AppContext","AppProvider","children","_s","recentAnalyses","setRecentAnalyses","loadingAnalyses","setLoadingAnalyses","analysesError","setAnalysesError","selectedProducts","setSelectedProducts","preferences","setPreferences","darkMode","showScores","defaultView","notifications","setNotifications","fetchRecentAnalyses","console","log","response","getAnalysisHistory","data","analyses","error","toggleProductSelection","productId","prevSelected","safeSelected","Array","isArray","includes","newSelection","filter","id","length","addNotification","type","message","duration","clearSelectedProducts","updatePreferences","newPreferences","localStorage","setItem","JSON","stringify","notification","Date","now","newNotification","prev","setTimeout","removeNotification","storedPreferences","getItem","parse","contextValue","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","propTypes","node","isRequired","useAppContext","_s2","context","undefined","Error","i","$RefreshReg$"],"sources":["/Users/deocherisme/environmental-impact-analyzer/frontend/src/context/AppContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { analysisAPI } from '../services/api';\n\n// Create context\nconst AppContext = createContext();\n\n/**\n * AppContext Provider Component\n * Manages global application state\n */\nexport const AppProvider = ({ children }) => {\n  // Recent analyses state\n  const [recentAnalyses, setRecentAnalyses] = useState([]);\n  const [loadingAnalyses, setLoadingAnalyses] = useState(false);\n  const [analysesError, setAnalysesError] = useState(null);\n  \n  // Selected products for comparison - initialize as empty array\n  const [selectedProducts, setSelectedProducts] = useState([]);\n  \n  // User preferences (could be expanded or stored in localStorage)\n  const [preferences, setPreferences] = useState({\n    darkMode: false,\n    showScores: true,\n    defaultView: 'grid',\n  });\n  \n  // Notifications\n  const [notifications, setNotifications] = useState([]);\n  \n  // Fetch recent analyses on component mount\n  useEffect(() => {\n    fetchRecentAnalyses();\n    console.log('AppContext initialized');\n  }, []);\n  \n  // Function to fetch recent analyses\n  const fetchRecentAnalyses = async () => {\n    try {\n      setLoadingAnalyses(true);\n      setAnalysesError(null);\n      \n      const response = await analysisAPI.getAnalysisHistory();\n      setRecentAnalyses(response.data.analyses || response.data || []);\n      \n    } catch (error) {\n      console.error('Error fetching analyses:', error);\n      setAnalysesError('Failed to load recent analyses');\n    } finally {\n      setLoadingAnalyses(false);\n    }\n  };\n  \n  // Add or remove product from selected products for comparison - ENHANCED WITH DEBUGGING\n  const toggleProductSelection = (productId) => {\n    console.log('toggleProductSelection called with:', productId);\n    \n    // Guard against undefined values\n    if (!productId) {\n      console.error('Attempted to toggle selection with invalid productId:', productId);\n      return;\n    }\n    \n    setSelectedProducts(prevSelected => {\n      console.log('Previous selected products:', prevSelected);\n      \n      // Make a defensive copy of prevSelected to ensure it's an array\n      const safeSelected = Array.isArray(prevSelected) ? [...prevSelected] : [];\n      \n      // Check if already selected\n      if (safeSelected.includes(productId)) {\n        console.log('Removing product from selection');\n        const newSelection = safeSelected.filter(id => id !== productId);\n        console.log('New selection will be:', newSelection);\n        return newSelection;\n      } else {\n        // Add if fewer than 3 already selected\n        if (safeSelected.length < 3) {\n          console.log('Adding product to selection');\n          const newSelection = [...safeSelected, productId];\n          console.log('New selection will be:', newSelection);\n          return newSelection;\n        } else {\n          console.log('Selection limit reached, not adding');\n          // Add notification about max products\n          addNotification({\n            type: 'warning',\n            message: 'You can only compare up to 3 products at a time',\n            duration: 3000\n          });\n          return safeSelected;\n        }\n      }\n    });\n  };\n  \n  // Clear all selected products\n  const clearSelectedProducts = () => {\n    console.log('Clearing all selected products');\n    setSelectedProducts([]);\n  };\n  \n  // Update user preferences\n  const updatePreferences = (newPreferences) => {\n    setPreferences({ ...preferences, ...newPreferences });\n    \n    // In a real app, you might save preferences to localStorage\n    localStorage.setItem('userPreferences', JSON.stringify({\n      ...preferences,\n      ...newPreferences\n    }));\n  };\n  \n  // Add notification\n  const addNotification = (notification) => {\n    const id = Date.now();\n    const newNotification = {\n      id,\n      type: notification.type || 'info',\n      message: notification.message,\n      duration: notification.duration || 5000\n    };\n    \n    setNotifications(prev => [...prev, newNotification]);\n    \n    // Auto-remove notification after duration\n    if (newNotification.duration > 0) {\n      setTimeout(() => {\n        removeNotification(id);\n      }, newNotification.duration);\n    }\n  };\n  \n  // Remove notification\n  const removeNotification = (id) => {\n    setNotifications(prev => prev.filter(notification => notification.id !== id));\n  };\n  \n  // Load stored preferences from localStorage\n  useEffect(() => {\n    try {\n      const storedPreferences = localStorage.getItem('userPreferences');\n      if (storedPreferences) {\n        setPreferences(JSON.parse(storedPreferences));\n      }\n    } catch (error) {\n      console.error('Error loading preferences:', error);\n    }\n  }, []);\n  \n  // Debug effect to log selected products changes\n  useEffect(() => {\n    console.log('selectedProducts state changed to:', selectedProducts);\n  }, [selectedProducts]);\n  \n  // Value to be provided by the context\n  const contextValue = {\n    // Analyses\n    recentAnalyses,\n    loadingAnalyses,\n    analysesError,\n    fetchRecentAnalyses,\n    \n    // Products for comparison\n    selectedProducts,\n    toggleProductSelection,\n    clearSelectedProducts,\n    \n    // User preferences\n    preferences,\n    updatePreferences,\n    \n    // Notifications\n    notifications,\n    addNotification,\n    removeNotification\n  };\n  \n  return (\n    <AppContext.Provider value={contextValue}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\nAppProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\n/**\n * Custom hook to use the app context\n */\nexport const useAppContext = () => {\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useAppContext must be used within an AppProvider');\n  }\n  return context;\ni};\n\nexport default AppContext;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}